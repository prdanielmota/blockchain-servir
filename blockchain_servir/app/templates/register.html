{% extends "base.html" %}

{% block content %}
<h2>Cadastro Servir</h2>
<form method="POST">
    <label>Nome Completo</label>
    <input type="text" name="name" required>
    
    <label>Email</label>
    <input type="email" name="email" required>
    
    <label>WhatsApp (somente n√∫meros, ex: 5511999999999)</label>
    <input type="text" name="phone" required placeholder="5511999999999" value="{{ prefill_phone }}">
    
    <label>Senha</label>
    <input type="password" name="password" required>
    
    <button type="submit">Cadastrar</button>
</form>

<script>
    // Robust Phone Prefill for Safari/Mobile
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const phone = urlParams.get('phone');
        const phoneInput = document.querySelector('input[name="phone"]');
        
        if (phone && phoneInput) {
            // Remove non-digits just to be safe
            const cleanPhone = phone.replace(/\D/g, '');
            // Only update if input is empty (don't overwrite user typing)
            if (!phoneInput.value) {
                phoneInput.value = cleanPhone;
            }
        }
    }
</script>
{% endblock %}
